{
    "contents" : "#-------------------------------------------------------------------\n# Header\n#-------------------------------------------------------------------\n\n#-------------------------------------------------------------------\n# packages\n#-------------------------------------------------------------------\n\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(ggmap)\nlibrary(maptools)\nlibrary(maps)\n#-------------------------------------------------------------------\n# Data import : XML parsing\n#-------------------------------------------------------------------\n\nstorms <- read_csv('./ibtracs_2010.csv', col_names = TRUE)\n\n#-------------------------------------------------------------------\n# Data Analysis\n#-------------------------------------------------------------------\n# Perform an exploratory analysis of the pressure, wind speed, and duration of storms. Get descriptive\n# summaries (min, max, quartiles, mean, std deviation, etc), as well as histograms and/or boxplots.\n# In addition, answer the following questions (youâ€™ll also have to include them in the report):\n\n# descriptive summaries\nsummary(storms)\nhead(storms)\ntail(storms)\n\n# pressure\nmin(na.omit(storms$press))\nmax(na.omit(storms$press))\nsd(na.omit(storms$press))\nmean(na.omit(storms$press))\nquantile(na.omit(storms$press))\n\nboxplot(na.omit(storms$press), main = 'Box plot of pressure', ylab='Pressure (hPa)', horizontal = TRUE)\nhist(storms$press, xlab = 'Pressure (hPa)' , main = 'Histogram of Pressure')\n\n# wind speed\n\nmin(na.omit(storms$wind))\nmax(na.omit(storms$wind))\nsd(na.omit(storms$wind))\nmean(na.omit(storms$wind))\nquantile(na.omit(storms$wind))\n\nboxplot(storms$wind, main = 'Box plot of Wind', ylab='Wind (kt)', horizontal = TRUE)\nhist(storms$wind, xlab = 'Wind (kt)' , main = 'Histogram of Wind')\n\n# duration of storms\n\nduration <- sapply(unique(storms$name), function(x) {max(storms$date[storms$name == x]) - min(storms$date[storms$name == x])})\n\nmin(duration)\nmax(duration)\nsd(duration)\nmean(duration)\nquantile(duration)\n\nhist(duration)\nboxplot(duration, horizontal = TRUE, main= 'Boxplot of duration', xlab = 'Duration (days)')\n\n# Total number of storms in 2010\n\nsum(format(storms$date, '%Y') == '2010')\n\n# Number of storms with winds >= 35 knots (tropical storms)\nsum((storms$wind >= 35), na.rm = TRUE)\n\n# Number of storms with winds >= 64 knots (hurricanes)\nsum((storms$wind >= 64), na.rm = TRUE)\n\n# Number of storms with winds >= 96 knots (major hurricanes)\nsum((storms$wind >= 96), na.rm = TRUE)\n\n# Number of storms per hemisphere (north and south)\n\n# num_north : number of storms on the north hemisphere\n# num_south : number of storms on the south hemisphere\n\nnum_north <- sum(storms$longitude >= 0, na.rm = TRUE)\nnum_south <- sum(storms$longitude < 0, na.rm = TRUE)\n\n# Frequency table with data points per month (month in words)\n\nmonth <- months(storms$date)\nfreq_month <- table(month)\nfreq_month <- freq_month[month.name]\nfreq_month\n\n#  Frequency table with data points per month (month in words) in northern hemisphere\n\nmonth_north <- months(storms$date[na.omit(storms$longitude >= 0)])\nfreq_north <- table(month_north)\nfreq_north <- freq_north[month.name]\nfreq_north\n\n# Frequency table with data points per month (month in words) in southern hemisphere\n# (we can find this value in two ways)\n\n# month_south <- months(storms$date[na.omit(storms$longitude < 0)])\n# freq_south <- table(month_south)\n# freq_south <- freq_south[month.name]\n\nfreq_south <- freq_month - freq_north\nfreq_south\n\n# Name of storm that lasted most days\nnames(which.max(duration))\n\n# Name of storm with maximum wind speed (and speed value)\n\nunique(storms$name[na.omit(storms$wind == max(storms$wind, na.rm = TRUE))])\nmax(storms$wind, na.rm = TRUE)\n\n# Name of storm with minimum pressure (and pressure value)\n\nunique(storms$name[na.omit(storms$press == min(storms$press, na.rm = TRUE))])\nmin(storms$press, na.rm = TRUE)\n\n#-------------------------------------------------------------------\n# Data Visualization\n#-------------------------------------------------------------------\n\n# plotting the storm coordinates (longitude and latitude) with points()\nmap()\nwith(storms,\n     points(longitude, latitude, pch = '.', col = 'red'))\n\n# Draw storm occurence locations on the world map \nmp <- NULL\nmapWorld <- borders(\"world\", colour=\"#dd855c40\", fill=\"#67b988\") # create a layer of borders\nmp <- ggplot() + mapWorld\nmp <- mp+ geom_point(aes(x=storms$longitude, y=storms$latitude), col = '#1a3a4990', size=3) \nmp <- mp + ggtitle('IBTrACS Storms 2010 Map')\nmp <- mp + xlab('Longitude') + ylab('Latitude')\nmp <- mp + theme(panel.background = element_rect(fill = \"#aae6f6\"),\n                 panel.grid.major = element_blank(),\n                 panel.grid.minor = element_blank())+\n      geom_hline(yintercept = 0 , col='#285658a0', linetype = 2)\nmp\n\n# Draw the same graph with color that varies by the wind speed\nmp1 <- NULL\nmapWorld <- borders(\"world\", colour=\"#dd855c40\", fill=\"#67b988\") # create a layer of borders\nmp1 <- ggplot(storms, aes(x=longitude, y=latitude, col = wind) ) + mapWorld\nmp1 <- mp1+ geom_point(pch= 20, size=3) \nmp1 <- mp1 + ggtitle('IBTrACS Storms 2010 Map')\nmp1 <- mp1 + xlab('Longitude') + ylab('Latitude')\nmp1 <- mp1 + theme(panel.background = element_rect(fill = \"#aae6f6\"),\n                 panel.grid.major = element_blank(),\n                 panel.grid.minor = element_blank())\nmp1 <- mp1 + geom_hline(yintercept = 0 , col='#285658a0', linetype = 2)\n \nmp1\n\nhead(storms)\n",
    "created" : 1438321141748.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2953916233",
    "id" : "23EBBCC2",
    "lastKnownWriteTime" : 1438327808,
    "path" : "~/Downloads/homework07/data_analysis.R",
    "project_path" : "data_analysis.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}